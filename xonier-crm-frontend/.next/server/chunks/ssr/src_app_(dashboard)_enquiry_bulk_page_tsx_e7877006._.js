module.exports=[85711,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(42343);function e(a){return(0,d.GenIcon)({tag:"svg",attr:{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z",clipRule:"evenodd"},child:[]}]})(a)}var f=a.i(71682),g=a.i(83490),h=a.i(49909),i=a.i(20094),j=a.i(89254),k=a.i(82353),l=a.i(42068),m=a.i(27348),n=a.i(50944);a.s(["default",0,()=>{let[a,d]=(0,c.useState)([]),[o,p]=(0,c.useState)(1),[q,r]=(0,c.useState)(!1),[s,t]=(0,c.useState)(null),[u,v]=(0,c.useState)(!1),[w,x]=(0,c.useState)(""),y=Math.ceil(a.length/10),z=(0,n.useRouter)(),A=a.slice((o-1)*10,10*o),B=async a=>{let[b,...c]=(await a.text()).split("\n").filter(Boolean),d=b.split(",").map(a=>a.trim());return c.map(a=>{let b=a.split(",").map(a=>a.trim()),c={};return d.forEach((a,d)=>c[a]=b[d]||null),c})},C=async a=>{if(!a.name.endsWith(".csv"))return alert("Only CSV allowed");t(a),d(await B(a)),p(1)},D=()=>{t(null),d([]),p(1)},E=async b=>{if(b.preventDefault(),x(""),0===a.length)return void i.toast.warn("No enquiries to upload");v(!0);try{let b=await j.EnquiryService.bulkCreate({enquiries:a});201===b.status&&(i.toast.success("Bulk enquiries created successfully"),D(),d([]),z.push("/enquiry"))}catch(a){if(console.error(a),g.default.isAxiosError(a)){let b=(0,h.default)(a);x(b),i.toast.error(`${b}`)}else x(["Something went wrong"])}finally{v(!1)}};return(0,b.jsxs)("div",{className:"ml-72 mt-14 p-6 space-y-6",children:[(0,b.jsxs)("div",{className:"bg-white dark:bg-gray-700 rounded-xl p-6 flex justify-between items-center",children:[(0,b.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,b.jsx)("h2",{className:"text-2xl font-bold",children:"Bulk Enquiries"}),(0,b.jsx)("p",{className:"text-gray-500 dark:text-gray-200",children:"Upload CSV to create enquiries in bulk, download the sample sheet and update it"})]}),(0,b.jsxs)("button",{onClick:()=>{let a=new Blob([[["fullName","email","phone","companyName","projectType","priority","source","message"],["Rahul Sharma","rahul@test.com","9999999999","ABC Pvt Ltd","website","high","website","Need business website"],["Neha Verma","neha@test.com","8888888888","XYZ Corp","mobile_app","medium","google_ads","Mobile app enquiry"],["Amit Singh","amit@test.com","7777777777","StartupX","ai_ml","high","linkedin_ads","AI solution"],["Priya Mehta","priya@test.com","6666666666","","crm","low","referral","CRM requirement"]].map(a=>a.join(",")).join("\n")],{type:"text/csv"}),b=URL.createObjectURL(a),c=document.createElement("a");c.href=b,c.download="bulk-enquiry-sample.csv",c.click(),URL.revokeObjectURL(b)},className:"bg-blue-600 hover:bg-blue-700 text-white px-5 py-2.5 rounded-md flex items-center gap-2",children:[(0,b.jsx)(e,{})," Download Sample"]})]}),w&&(0,b.jsx)(k.default,{error:w}),(0,b.jsx)(l.default,{message:""}),(0,b.jsx)("div",{onDragOver:a=>{a.preventDefault(),r(!0)},onDragLeave:()=>r(!1),onDrop:a=>{a.preventDefault(),r(!1),a.dataTransfer.files[0]&&C(a.dataTransfer.files[0])},className:`bg-white dark:bg-gray-700 rounded-xl p-12 border-2 border-dashed transition
          ${q?"border-blue-500 bg-blue-50":"border-gray-300"}`,children:(0,b.jsxs)("div",{className:"flex flex-col items-center gap-3",children:[(0,b.jsx)(f.FaFileCsv,{className:"text-4xl text-gray-400 dark:text-gray-300"}),(0,b.jsx)("p",{className:"text-gray-600 dark:text-gray-300",children:"Drag & drop your CSV file here"}),(0,b.jsx)("input",{type:"file",accept:".csv",className:"hidden",id:"csvUpload",onChange:a=>a.target.files&&C(a.target.files[0])}),(0,b.jsxs)("label",{htmlFor:"csvUpload",className:"cursor-pointer bg-blue-600 text-white px-4 py-2 rounded-md flex items-center gap-2 hover:bg-blue-700",children:[(0,b.jsx)(f.FaUpload,{})," Choose File"]}),s&&(0,b.jsxs)("div",{className:"flex items-center gap-3 mt-3 bg-gray-100 dark:bg-gray-800 px-4 py-2 rounded-md",children:[(0,b.jsx)("span",{className:"text-sm font-medium",children:s.name}),(0,b.jsxs)("span",{className:"text-xs text-gray-500",children:[a.length," rows"]}),(0,b.jsx)("button",{onClick:D,className:"text-red-500",children:(0,b.jsx)(f.FaTrash,{})})]})]})}),a.length>0&&(0,b.jsxs)("div",{className:"bg-white dark:bg-gray-700 rounded-xl overflow-hidden",children:[(0,b.jsxs)("table",{className:"w-full text-sm",children:[(0,b.jsx)("thead",{className:"bg-gray-100 dark:bg-gray-800",children:(0,b.jsx)("tr",{children:["Name","Email","Phone","Project","Priority","Source"].map(a=>(0,b.jsx)("th",{className:"p-3 text-left uppercase text-xs",children:a},a))})}),(0,b.jsx)("tbody",{children:A.map((a,c)=>(0,b.jsxs)("tr",{className:"border-t hover:bg-gray-50 dark:hover:bg-gray-800",children:[(0,b.jsx)("td",{className:"p-3",children:a.fullName}),(0,b.jsx)("td",{className:"p-3",children:a.email}),(0,b.jsx)("td",{className:"p-3",children:a.phone}),(0,b.jsx)("td",{className:"p-3 capitalize",children:a.projectType}),(0,b.jsx)("td",{className:"p-3 capitalize",children:a.priority}),(0,b.jsx)("td",{className:"p-3 capitalize",children:a.source})]},c))})]}),(0,b.jsxs)("div",{className:"flex justify-between items-center p-4",children:[(0,b.jsxs)("span",{className:"text-sm text-gray-500",children:["Showing ",(o-1)*10+1,"â€“",Math.min(10*o,a.length)," of"," ",a.length]}),(0,b.jsx)("div",{className:"flex gap-2",children:Array.from({length:y}).map((a,c)=>(0,b.jsx)("button",{onClick:()=>p(c+1),className:`px-3 py-1 rounded ${o===c+1?"bg-blue-600 text-white":"bg-gray-200 hover:bg-gray-300 dark:hover:bg-gray-800"}`,children:c+1},c))})]})]}),a.length>0&&(0,b.jsx)("form",{onSubmit:E,className:"flex justify-end",children:(0,b.jsxs)("button",{type:"submit",disabled:u,className:"w-fit flex items-center justify-center gap-2 rounded-md px-4 py-2 font-medium bg-blue-600 text-white hover:bg-blue-700 hover:cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,b.jsx)(m.FiUpload,{})," ",u?"Uploading...":"Create Enquiries"]})})]})}],85711)}];

//# sourceMappingURL=src_app_%28dashboard%29_enquiry_bulk_page_tsx_e7877006._.js.map